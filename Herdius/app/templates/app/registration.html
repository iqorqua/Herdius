{% extends "app/layout.html" %}

{% block content %}
{% load staticfiles %}
<!--links-->
	<link rel="stylesheet" href="{% static 'app/content/registration.css' %}">
	<link rel="stylesheet" href="{% static 'app/content/datepicker.min.css' %}">
	<link rel="stylesheet" href="{% static 'app/content/validator.css' %}">
	<link rel="stylesheet" href="{% static 'app/content/intlTelInput.css' %}">
<!--/links-->
		<!-- Background Image -->
		<div class="bg-img" position: fixed"><!--style="background-image: url('{% static 'app/img/background1.jpg' %}'); position: fixed">-->
			<div class="overlay"></div>
		</div>
		<!-- /Background Image -->

        <div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" id="myModal">
          <div class="modal-dialog modal-lg">
            <div class="modal-content" style="line-height: 2;">
                <h2>License agreement</h2>
              <p>The LIBLICENSE Model License Agreement is part of an ongoing effort to provide timely and responsive information and assistance to librarians involved in licensing and maintaining digital collections. The terms of the initial 2001 Standard License Agreement (revised through 2008) have now formed the basis for a completely updated revision.  In November 2014, this totally revised and recast model license has been posted, after intense, year-long discussions and collaborations with numerous stakeholders; for fuller information, see the <a href="http://liblicense.crl.edu/wp-content/uploads/2014/12/12-03-2014PM-FINAL-Model-License_announce.pdf" onclick="_gaq.push(['_trackEvent','download','http://liblicense.crl.edu/wp-content/uploads/2014/12/12-03-2014PM-FINAL-Model-License_announce.pdf']);" target="_blank">press release</a>.  We welcome comments — please send to <a href="mailto:aokerson@crl.edu">Ann Okerson</a>, Liblicense project director.</p>
              <p>The effort was made possible by support from the Center for Research Libraries and with funding from the Andrew W. Mellon Foundation.  As with the initial version, the Council for Library and Information Resources has provided support and encouragement.  We thank also our new contributors to this significant effort:  the Association of Research Libraries, the California Digital Library, the New England Law Library Consortium, and the Canadian Research Knowledge Network.  The hard-working development team, without whom this new version would not have been possible, include:  Ivy Anderson (CDL); Julia Blixrud (ARL); Tracy Thompson (NELLCO); Craig Olsvik (CRKN); Christa Williford (CLIR); and Ann Okerson (CRL) as Convener.  Extra acknowledgement goes to Lisa Macklin, MLS, JD, Director of the Scholarly Communications Office, Emory University Libraries, for her expert role in developing numerous version of the document.  Thanks also to the dozens of individuals who offered comments on the draft in progress.  Every comment was studied by the team and served to improve the Model License.</p>
              <p>The LIBLICENSE Model License Agreement provides both a template that can be used by university librarians in negotiating particular licensing agreements and, more generally, serves as a statement by the academic library community of what it considers acceptable policy and practice for licensing digital information. It is neither expected nor intended that this Model License Agreement be the last word on contract terms for digital materials. To the contrary, we encourage all members of the academic and publishing communities involved with the distribution of digital materials to comment on, criticize, add to, and subtract from this version. Revised versions reflecting user comments as well as changes in the digital information environment will be posted periodically on this Web site. We will also maintain an archive of all prior drafts.</p>
            </div>
              
              <div class="modal-footer">
                  <button type="button" id="registerNewUser" class="btn signin">I agree!</button>
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">I don`t agree!</button>
              </div>
         </div>
</div>
<!-- Top content -->
        <div class="top-content">
        	
            <div class="inner-bg">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-8 col-sm-offset-2 form-box">
                        	
                        	<form method="post" id="fileinfo" name="fileinfo" onsubmit="return submitForm();" class="registration-form">
                        		<fieldset>
		                        	<div class="form-top">
		                        		<div class="form-top-left">
		                        			<h3 style="color:#063783">Wellcome to OPK Token</h3>
		                        			<h3 style="color:#4cbac9">Presale Registration</h3>
		                            		<p style="line-height: 1.5;">Please fill required fields to request presale participation. 
                                    You`ll be directly contacted with our representative. 
                                    Then SAFT (Simple Agreemenr For Future Tokens) will be prepared close the dial.</p>
		                        		</div>
		                        		<div class="form-top-right">
		                        			<i class="fa fa-times-circle" style="font-size: 25px;"></i>
		                        		</div>
		                            </div>
		                            <div class="form-bottom">                                        
				                    	<div class="form-group">
				                    		<label class="sr-only" for="form-user-name">User name</label>
				                        	<input type="text" name="username" placeholder="User name..." class="form-user-name form-control" id="username">
				                        </div>
				                    	<div class="form-group">
				                    		<label class="sr-only" for="form-first-name">First name</label>
				                        	<input type="text" name="first_name" placeholder="First name..." class="form-first-name form-control" id="first_name">
				                        </div>
				                        <div class="form-group">
				                        	<label class="sr-only" for="form-last-name">Last name</label>
				                        	<input type="text" name="last_name" placeholder="Last name..." class="form-last-name form-control" id="last_name">
				                        </div>
				                        <div class="form-group">
				                        	<label class="sr-only" for="form-birthday">Birthday</label>
				                        	<input type="text" name="bday" placeholder="Birthday..." class="form-birthday datepicker-here form-control" id="bday" data-position="right center">
				                        </div>
				                    	<div class="form-group">
				                    		<label class="sr-only" for="form-country">Country</label>
				                        	<input type="text" name="country" placeholder="Country..." class="form-country form-control" id="country">
				                        </div>
				                        <div class="form-group">
				                        	<label class="sr-only" for="form-twitter">City, adress...</label>
				                        	<textarea name="adress" placeholder="City, adress..." 
				                        				class="form-address form-control" id="adress"></textarea>
				                        </div>
				                        <div class="form-group">
				                        	<label class="sr-only" for="form-postal-code">Postal code</label>
				                        	<input type="text" name="postal_code" placeholder="Postal code..." class="form-postal-code form-control" id="postal_code">
				                        </div>
				                        <div class="form-group">
				                        	<label class="sr-only" for="form-phone">Phone</label>
				                        	<input placeholder="Phone..." class="form-phone form-control" id="phone" name="phone" type="tel">
				                        </div>
				                        <div class="form-group">
				                        	<label class="sr-only" for="form-email">Email</label>
				                        	<input type="text" name="email" placeholder="Email..." class="form-email form-control" id="email">
				                        </div>
				                        <div class="form-group">
				                    		<label class="sr-only" for="form-password">Password</label>
				                        	<input type="password" name="password" placeholder="Password..." class="form-password form-control" id="password">
				                        </div>
				                        <div class="form-group">
				                        	<label class="sr-only" for="form-repeat-password">Repeat password</label>
				                        	<input type="password" name="password1" placeholder="Repeat password..." 
				                        				class="form-repeat-password form-control" id="password1">
                                        <input type="file"  class="form-control-file" name="avatar" id="avatar" required=""/>
                                        <input type="file"  class="form-control-file" name="picture_id" id="picture_id" required="" />
				                        </div>
                                        <div class="form-group">
                                            <input type="checkbox" class="form-check-input" id="ch_b_areement" name="ch_b_areement">
                                            <label class="form-check-label" for="exampleCheck1">I accept the Terms and Conditions of use the service and the Pricacy policy</label>
                                        </div>
                                        <script src='https://www.google.com/recaptcha/api.js'></script><div class="wrapper">
                                        <div class="g-recaptcha" data-sitekey="6LdRAmIUAAAAAMuzveig6oGUVTG60xMCpx-2dBTd" id="re"></div>
                                          
				                            <button type="button" class="btn btn-primary signin">Registrate</button>
                                        </div>
				                    </div>
			                    </fieldset>
			                    
			                    <fieldset>
		                        	<div class="form-top clipPolygon">
		                        		<div class="form-top-left">
		                        			<h3>Step 2 / 3</h3>
		                            		<p>Set up your account:</p>
		                        		</div>
		                        		<div class="form-top-right">
		                        			<i class="fa fa-key"></i>
		                        		</div>
		                            </div>
		                            <div class="form-bottom">
				                        <div class="form-group">

				                        </div>
				                    </div>
			                    </fieldset>
		                    
		                    </form>
		                    
                        </div>
                    </div>
                </div>
            </div>
            
        </div>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="{% static 'app/scripts/jquery.validate.min.js' %}"></script>
        <script src="{% static 'app/scripts/jquery-1.11.1.min.js' %}"></script>
        <script src="{% static 'app/scripts/bootstrap.min.js' %}"></script>
        <script src="{% static 'app/scripts/intlTelInput.js' %}"></script>
        <script src="{% static 'app/scripts/utils.js' %}"></script>
        <script src="{% static 'app/scripts/jquery.backstretch.js' %}"></script>
        <script src="{% static 'app/scripts/retina-1.1.0.min.js' %}"></script>
        <script src="{% static 'app/scripts/scripts.js' %}"></script>
        <script src="{% static 'app/scripts/datepicker.min.js' %}"></script>
        <script src="{% static 'app/scripts/jquery.validate.min.js' %}"></script>
        <script src="{% static 'app/scripts/validate.js' %}"></script>
        <script src="{% static 'app/scripts/jquery.validate.unobtrusive.min.js' %}"></script>
        <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.15.0/additional-methods.js"></script>
        <script>

            $('#bday').datepicker({
                language: 'en'
            })
                ;(function ($) { $.fn.datepicker.language['en'] = {
                days: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
                daysShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
                daysMin: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],
                months: ['January','February','March','April','May','June', 'July','August','September','October','November','December'],
                monthsShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                today: 'Today',
                clear: 'Clear',
                dateFormat: 'yyyy-mm-dd',
                timeFormat: 'hh:ii aa',
                firstDay: 0
            };
            })(jQuery);
                $('#bday').keydown(function(e){
                    e.preventDefault();
                });
            </script>    
        <script>
            jQuery.validator.setDefaults({
              debug: true,
              success: "valid"
            });
            var s = $("#fileinfo").validate({
                    rules: {

                        username: {
                            required: true,
                            minlength: 6,
                            maxlength: 16,
                        },

                        first_name: {
                            required: true,
                            minlength: 2,
                            maxlength: 16,
                        },

                        last_name: {
                            required: true,
                            minlength: 2,
                            maxlength: 16,
                        },

                        postal_code: {
                            required: true,
                            minlength: 4,
                            digits: true,
                        },

                        country: {
                            required: true,
                            minlength: 2,
                            maxlength: 16,
                        },

                        phone: {
                            required: true,
                            minlength: 5,
                            digits: true
                        },

                        bday: {
                            required: true,
                            minlength: 6,
                            maxlength: 16,
                        },


                        adress: {
                            required: true,
                            minlength: 6,
                            maxlength: 60,
                        },

                        email: {
                            required: true,
                            email: true
                        },

                        password: {
                            required: true,
                            minlength: 6,
                            equalTo: "#password1"
                        },

                        password1: {
                            required: true,
                            minlength: 6,
                            equalTo: "#password"
                        },
                        
                        avatar: {
                            required: true,
                            accept: "image/jpeg, image/pjpeg"
                        },

                        picture_id: {
                            required: true,
                            accept: "image/jpeg, image/pjpeg"
                        },
                        ch_b_areement: {
                            required: true,
                        },
                },
                    errorPlacement: function (error, element) {
                        var placement = $(element).data('error');
                        if (placement) {
                            $(placement).append(error)
                        } else {
                            error.addClass("error-my");
                            error.css("padding-left", $('#fileinfo').width() + 20, '!important');
                            error.insertBefore(element);
                        }
                    }
                });
        </script>

<script>
    $("#show_modal").click(function () {
         s.valid();
         if (!((!email_exists) &&(!user_exists) && s.element("#username") && s.element("#first_name") && s.element("#last_name") && s.element("#bday") && s.element("#country") && s.element("#adress") && s.element("#postal_code") && s.element("#phone") && s.element("#email") && s.element("#password1") && s.element("#password") && s.element("#avatar") && s.element("#picture_id"))) {
            return;
         };
        $('#myModal').modal('show');
    });
</script>
<script>    
    $(document).ready(function(){
       window.user_exists=false;
       window.email_exists=false;
    });
     function csrfSafeMethod(method) {
                    // these HTTP methods do not require CSRF protection
                    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
                }
   
    $(".signin").click(function () {
         s.valid();
         if (!((!email_exists) &&(!user_exists) && s.element("#username") && s.element("#first_name") && s.element("#last_name") && s.element("#bday") && s.element("#country") && s.element("#adress") && s.element("#postal_code") && s.element("#phone") && s.element("#email") && s.element("#password1") && s.element("#password") && s.element("#avatar") && s.element("#picture_id") && s.element("#ch_b_areement"))) {
            return;
         };
    $.ajaxSetup({
                    beforeSend: function(xhr, settings) {
                        if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                            xhr.setRequestHeader("X-CSRFToken", '{{ csrf_token }}');
                        }
                    }
                });
        var fd = new FormData(document.getElementById("fileinfo"));
        fd.append("username", $('#username').val());
        fd.append("first_name", $('#first_name').val());
        fd.append("last_name", $('#last_name').val());
        fd.append("postal_code", $('#postal_code').val());
        fd.append("country", $('#country').val());
        fd.append("phone", '+'+$(".selected-flag").attr ("title").split('+')[1] + $('#phone').val());
        fd.append("bday", $('#bday').val());
        fd.append("adress", $('#adress').val());
        fd.append("email", $('#email').val());
        fd.append("password", $('#password').val());
        fd.append("recapcha", grecaptcha.getResponse());
        fd.append("csrfmiddlewaretoken", '{{ csrf_token }}');
        $("#registerNewUser").prop("disabled",true);
        $.ajax({
           url: "{% url 'register' %}",
           type: "post", // or "get"
           
              processData: false,  // tell jQuery not to process the data
              contentType: false,
           dataType: 'json',
           data: fd,
           success: function(data) {
           alert(data['result'])
           $("#registerNewUser").prop("disabled",false);
    }});
     }); 
</script>

<script>
    $('#username').keyup(function() {
    $.ajaxSetup({
                    beforeSend: function(xhr, settings) {
                        if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                            xhr.setRequestHeader("X-CSRFToken", '{{ csrf_token }}');
                        }
                    }
                });
        var fd = new FormData();
        fd.append("username", $(this).val());
         $.ajax({
           url: "{% url 'emailusernamecheck' %}",
           type: "post", // or "get"
           
              processData: false,  // tell jQuery not to process the data
              contentType: false,
           dataType: 'json',
           data: fd,
           success: function(data) {
           if (data['username_exists'] == 'True'){ 
              $('#username').before('<label for="username" class="" id = "custom_error"">Name is not avalible. Try Anotner.</label>');
              $('#username').addClass('error');
              window.user_exists=true;
           }
           else{
              $('#custom_error').text('');              window.user_exists=false;
           }
    }});
    });
</script>
<script>
    global_em=false;
    $('#email').keyup(function() {
    $.ajaxSetup({
                    beforeSend: function(xhr, settings) {
                        if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                            xhr.setRequestHeader("X-CSRFToken", '{{ csrf_token }}');
                        }
                    }
                });
        var fd = new FormData();
        fd.append("email", $(this).val());
         $.ajax({
           url: "{% url 'emailusernamecheck' %}",
           type: "post", // or "get"
           
              processData: false,  // tell jQuery not to process the data
              contentType: false,
           dataType: 'json',
           data: fd,
           success: function(data) {
           if (data['email_exists'] == 'True'){ 
              $('#email').after('<label for="email" class="" id = "custom_error1"">Email is not avalible. Try Anotner.</label>');
              window.email_exists=true;
           }
           else{
              $('#custom_error1').text('');              window.email_exists=false;
           }
    }});
    });
</script>


<script>
    $("#phone").intlTelInput({
      utilsScript: "build/js/utils.js"
    });
  </script>
{% endblock %}
